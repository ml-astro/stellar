<!DOCTYPE html>
<html>

<head>
  <style>
    body {
      background-color: black;
      margin: 0;
      padding: 0;
    }

    h1,
    p {
      text-align: center;
    }

    h1 {
      color: white;
    }

    p {
      color: white;
      font-size: 22px;
    }

    button {
      display: block;
      font-weight: bold;
      height: 3em;
      background-color: #CCC;
      margin-bottom: 2em;
      width: 100px;
      border-radius: 10px;
    }

    .system {
      width: 70%;
      display: inline-block;
    }

    #buttonBlock {
      /*      width: 20%;*/
      position: absolute;
      right: 10px;
      top: 50%;
    }
  </style>

</head>

<body>
  <h1>Brightest Planets</h1>
  <p id="dateField"></p>
  <div id="buttonBlock">
    <button onclick="animationSpeed(-10)">&#60;&#60;&#60;</button>
    <button onclick="animationSpeed(-5)">&#60;&#60;</button>
    <button onclick="animationSpeed(-1)">&#60;</button>
    <button onclick="stop()">Stop</button>
    <button onclick="animationSpeed(1)">&#62;</button>
    <button onclick="animationSpeed(5)">&#62;&#62;</button>
    <button onclick="animationSpeed(10)">&#62;&#62;&#62;</button>
    <button onclick="zoomView('out')">zoom out</button>
    <button onclick="zoomView('in')">zoom in</button>

  </div>
  <div class="system">
    <canvas id="myCanvas" width="1000px" height="1000px"></canvas>
  </div>
  <script>
    //даты для расчета изначального отступа
    const date1 = new Date('2024-12-21');
    const date2 = new Date();
    const canvas = document.getElementById('myCanvas');
    const ctx = canvas.getContext('2d');
    //изначальный отступ
    const originalDaysOffset = ((date2 - date1) / 86400000);
    //переменная для подсчета отступа от оригинала, используется при генерировании системы
    var daysOffset = originalDaysOffset;
    //создаем счетчик
    let animate;
    let speed;
    var zoom = 1;
    //initial system for today
    generateSystem(originalDaysOffset, zoom);


    //создать новую дату
    function animationSpeed(x){
      clearInterval(animate)
      speed = x;
      animate = setInterval(add, 100);
    }

    //add days for next frame
    function add(){
      daysOffset+=speed;
      generateSystem(daysOffset, zoom);
      displayDate();
    }
    
    //stop animation
    function stop(){
      clearInterval(animate);
    }
    
    /*display date on screen*/
    function displayDate(){
      var date3 = new Date();
      date3.setDate(date1.getDate() + daysOffset);
      let month = parseInt(date3.getMonth()) + 1;
      let dateString = date3.getDate() + '/' + month + '/' + date3.getFullYear();
      document.getElementById('dateField').textContent = dateString;
    }

    function zoomView(mode) {
      if (mode == 'in') {
        zoom -= 0.1;
      }
      if (mode == 'out') {
        zoom += 0.1;
      }
      generateSystem(daysOffset, zoom);
    }


    function generateSystem(delay, zoom) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      const centerX = 500;
      const centerY = 500;
      ctx.fillStyle = 'black';
      ctx.fillRect(10, 10, canvas.height, canvas.height);

      //draw sun
      ctx.beginPath();
      ctx.arc(centerX, centerY, 10, 0, 2 * Math.PI);
      ctx.fillStyle = 'yellow';
      ctx.fill();


      const planets = [
        {
          distance: 57.9,
          offset: -161.72,
          step: 4.0923,
          color: "#AAA",
          size: 3,
        },
        {
          distance: 108.2,
          offset: -34.6,
          step: 1.6021,
          color: "#EEE",
          size: 4,
        },
        {
          distance: 149.0,
          offset: -90.0,
          step: 0.985609,
          color: "#44F",
          size: 4,
        },
        {
          distance: 228.0,
          offset: -104.29,
          step: 0.52403,
          color: "#F33",
          size: 3,
        },
        {
          distance: 778.5,
          offset: -77.44,
          step: 0.0831,
          color: "#E99",
          size: 8,
        },
        {
          distance: 1432.0,
          offset: -349.437,
          step: 0.0335,
          color: "#CAA",
          size: 8,
        }
      ];


      planets.forEach(planet => {
        //draw orbit
        ctx.strokeStyle = 'white';
        ctx.beginPath();
        ctx.arc(centerX, centerY, planet.distance / zoom, 0, 2 * Math.PI);
        ctx.stroke();

        //calculate phase
        let phase = (planet.offset - planet.step * delay) * Math.PI / 180;
        //draw planet with translation applied
        ctx.save();
        ctx.translate(centerX, centerY);
        ctx.rotate(phase);
        ctx.beginPath();
        ctx.arc(planet.distance / zoom, 0, planet.size*2, 0, 2 * Math.PI);
        ctx.fillStyle = planet.color;
        ctx.fill();
        ctx.restore();
      });
    }

  </script>
</body>

</html>